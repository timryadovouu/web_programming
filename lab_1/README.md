## Lab 1

### TL;DR

Необходимо разработать онлайн чат для пользователей, состоящий из двух микросервисов. Первый на Python FastAPI будет отвечать за регистрацию, аутентификацию, создание и поиск чат-комнат. Второй на Python FastAPI будет отвечать за функционал Websocket чата. Хранение данных должно быть реализовано в PostgreSQL либо в MongoDB. Аутентификация в чате должна происходить на основе JWT токенов.

#

### Сценарий использования

- Пользователь заходит на главную страницу сайта и видит приглашение к регистрации либо аутентификации. Он может зарегистрироваться или войти, введя email и пароль.
- Авторизованный пользователь может создавать новые чат-комнаты (название), видеть список своих созданных комнат и удалять свои комнаты. Авторизованный пользователь видит окно поиска чатов по названию. Можно ввести любой текст от 6 символов и получить список всех чатов, содержащих данное слово.
- По клику на название чата (из своего списка, либо из результатов поиска) пользователь переходит на страницу чата, содержащую сообщения (историю поддерживать не требуется) и окно для ввода нового сообщения. Каждое сообщение, которое вводит любой из пользователей в данном чате, сразу отображается у всех подключенных в данный момент пользователей (у которых в браузере открыта страница данного чата).
- Когда пользователь только открывает страницу. У всех отображается информация о том, что новый пользователь подключился.

#

### Техническое задание

Разработать и настроить следующие компоненты:

- Микросервис website – функционал управления пользователями, комнатами;
- Микросервис chat – функционал Websocket чатов;
- База данных;
- Веб-сервер.

#

### Требования в сервису website

1. Должен быть разработан на языке Python с использованием фреймворка FastAPI;
2. Фронтенд должен быть реализован с использованием Jinja2 шаблонов;
3. Хранение и извлечение данных должно быть в БД PostgreSQL либо MongoDB по выбору;
4. Доступ к БД только с использованием ORM библиотек;
5. Фронтенд может быть минималистичным, но должен быть аккуратным;
6. Должен использоваться механизм сессий;
7. Страница с чатом должна быть реализована на стороне фронтенда с использованием API микросервиса chat;
8. Взаимодействие с chat должно происходить с помощью JavaScript;
9. Аутентификация в chat решается посредством генерации подписанного JWT токена, содержащего (email пользователя и название чата) и передачи его в chat в HTTP заголовке;
10. Должен выделяться JWT токен только для существующих чатов и существующих пользователей.

#

### Требования к сервису chat

1. Должен быть разработан на языке Python;
2. Должен использовать Websocket протокол;
3. Не должен хранить никакой информации кроме открытых комнат и подключенных к ним пользователей;
4. Аутентификация пользователей должна выполняться через проверку JWT токена;
5. Должен иметь метод приема сообщения и поддерживать рассылку сообщения по всем пользователям, подключенным к данной чат комнате.

#

### Требования к базе данных

1. Должна быть выбрана БД PostgreSQL или MongoDB;
2. Должен быть настроен доступ к БД по логину и паролю;
3. Должна быть продумана и описана структура БД в отчете.

#

### Требования к веб серверу

1. Должен использоваться веб сервер Nginx;
2. Должен быть настроен Proxy pass на оба микросервиса: HTTP для website и Websocket для chat по пути /ws;
3. Должно быть настроено логирование запросов.

#

### Общие требования

1. Весь проект должен быть упакован с использованием Docker.
2. Должна поддерживаться следующая структура директории:
3. В корне расположен docker-compose.yml и README.md;
4. Каждый микросервис, его код и Dockerfile расположены в своей директории (website, chat, db, nginx).
5. Наружу должен быть доступен только 1 HTTP порт;
6. База данных должна обеспечивать persistence в локальную директорию dump;
7. Должны быть настроены файлы .gitignore и .dockerignore.

#

### Требования к отчету

1. Отчет в формате Docx в соответствии с приложенным шаблоном;
2. Заполнение каждого из следующих разделов:
3. Описание архитектуры ПО;
4. Описание структуры базы данных;
5. Описание протокола и форматов передачи данных;
6. Описание API;
7. Скриншоты функционала (каждая страница и кейс из технического задания).
8. Приложите ключевые файлы с кодом (website backend и chat backend) в главы приложений отчета;
9. Приложите код в виде ZIP архива к отчету.

#

### Что и как сдавать

Вы прикладываете 2 файла:

1. Отчет в формате DOCX, имеющий название: Фамилия_Имя_webdev_lab_1.docx
2. Приложение с кодом в формате ZIP, имеющее название Фамилия_Имя_webdev_lab_1.zip
3. Никакой из файлов не должен превышать 2 мегабайта
4. Неправильно оформленные работы будут отклоняться на доработку, обратите внимание!
